//~ try {//~     var xLib = new ExternalObject("lib:\PlugPlugExternalObject");//~ } catch (e) {//~     alert(e);//~ }//~  //~  function dispatchCEPEvent(_type,_data){//~     if (xLib) {//~         var eventObj = new CSXSEvent(); //~         $.writeln("type: " + _type);//~         eventObj.type = "_type;//~         eventObj.data = _data;//~         eventObj.dispatch();//~     }//~ }//~ function mainRoutine(){//~     dispatchCEPEvent('testEvent', "This is a test!!!!");//~  }//~ mainRoutine();var docRef;    function addNew(){         // open a new document in Photoshop         var inputFile = new File("/Users/gaappr/Desktop/test.jpg");        docRef = app.open( inputFile );                /*app.documents.add(            UnitValue(550, "px"),	// width            UnitValue(450, "px"),	// height            72,			// resolution            "Hello world",		// title            NewDocumentMode.RGB,	// color mode            DocumentFill.WHITE	// bg color        ); */        return "done";     }  function getDocMode(){        return docRef.mode;}